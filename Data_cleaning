--combining the goodlyrics column
update words set good_lyrics1='1' 
where 
(good_lyrics='1' and
good_lyrics1='1')or
(good_lyrics='1' and
good_lyrics1='0')or
(good_lyrics='0' and
good_lyrics1='1')
or (good_lyrics1 is null and good_lyrics='1')
or (good_lyrics1 ='1' and good_lyrics is null);


update words set good_lyrics1='0' 
where 
(good_lyrics='0' and
good_lyrics1='0')
or (good_lyrics1 is null and good_lyrics='0')
or (good_lyrics1 ='0' and good_lyrics is null);

-----scaling the heard of column
update words set HEARD_OF='HEARD OF' WHERE
HEARD_OF IN
(
'Ever heard of',
'Heard of');
update words set HEARD_OF='RECENTLY' WHERE
HEARD_OF IN
(
'Heard of and listened to music RECENTLY',
'Listened to recently');

-------cleaning teh own artist column
set OWN_ARTIST_MUSIC='DONT KNOW' WHERE
OWN_ARTIST_MUSIC IN
(
'DonÕt know',
'don`t know',
'DonÍt know');


----removing the null values and updating values with mean where required
UPDATE WORDS SET SOPHISTICATED='0' WHERE SOPHISTICATED='0.06';
UPDATE WORDS SET AGGRESSIVE='0.' WHERE AGGRESSIVE IS NULL;
UPDATE WORDS SET	EDGY	='0'	WHERE	EDGY	IS NULL	;
UPDATE WORDS SET	LAID_BACK	='0'	WHERE	LAID_BACK	IS NULL	;
UPDATE WORDS SET	WHOLESOME	='0'	WHERE	WHOLESOME	IS NULL	;
UPDATE WORDS SET	UPLIFTING	='0'	WHERE	UPLIFTING	IS NULL	;
UPDATE WORDS SET	INTRIGUING	='0'	WHERE	INTRIGUING	IS NULL	;
UPDATE WORDS SET	LEGENDARY	='0'	WHERE	LEGENDARY	IS NULL	;
UPDATE WORDS SET	FREE	='0'	WHERE	FREE	IS NULL	;
UPDATE WORDS SET	THOUGHTFUL	='0'	WHERE	THOUGHTFUL	IS NULL	;
UPDATE WORDS SET	OUTSPOKEN	='0'	WHERE	OUTSPOKEN	IS NULL	;
UPDATE WORDS SET	SERIOUS	='0'	WHERE	SERIOUS	IS NULL	;
UPDATE WORDS SET	UNATTRACTIVE	='0'	WHERE	UNATTRACTIVE	IS NULL	;
UPDATE WORDS SET	CONFIDENT	='0'	WHERE	CONFIDENT	IS NULL	;
UPDATE WORDS SET	OLD	='0'	WHERE	OLD	IS NULL	;
UPDATE WORDS SET	YOUTHFUL	='0'	WHERE	YOUTHFUL	IS NULL	;
UPDATE WORDS SET	BORING	='0'	WHERE	BORING	IS NULL	;
UPDATE WORDS SET	CURRENTS	='0'	WHERE	CURRENTS	IS NULL	;
UPDATE WORDS SET	COLOURFUL	='0'	WHERE	COLOURFUL	IS NULL	;
UPDATE WORDS SET	STYLISH	='0'	WHERE	STYLISH	IS NULL	;
UPDATE WORDS SET	CHEAP	='0'	WHERE	CHEAP	IS NULL	;
UPDATE WORDS SET	IRRELEVANT	='0'	WHERE	IRRELEVANT	IS NULL	;
UPDATE WORDS SET	HEARTFELT	='0'	WHERE	HEARTFELT	IS NULL	;
UPDATE WORDS SET	CALM	='0'	WHERE	CALM	IS NULL	;
UPDATE WORDS SET	PIONEER	='0'	WHERE	PIONEER	IS NULL	;
UPDATE WORDS SET	OUTGOING	='0'	WHERE	OUTGOING	IS NULL	;
UPDATE WORDS SET	INSPIRING	='0'	WHERE	INSPIRING	IS NULL	;
UPDATE WORDS SET	BEAUTIFUL	='0'	WHERE	BEAUTIFUL	IS NULL	;
UPDATE WORDS SET	FUN	='0'	WHERE	FUN	IS NULL	;
UPDATE WORDS SET	AUTHENTIC	='0'	WHERE	AUTHENTIC	IS NULL	;
UPDATE WORDS SET	CREDIBLE	='0'	WHERE	CREDIBLE	IS NULL	;
UPDATE WORDS SET	WAY_OUT	='0'	WHERE	WAY_OUT	IS NULL	;
UPDATE WORDS SET	COOL	='0'	WHERE	COOL	IS NULL	;
UPDATE WORDS SET	CATCHY	='0'	WHERE	CATCHY	IS NULL	;
UPDATE WORDS SET	SENSITIVE	='0'	WHERE	SENSITIVE	IS NULL	;
UPDATE WORDS SET	MAINSTREAM	='0'	WHERE	MAINSTREAM	IS NULL	;
UPDATE WORDS SET	SUPERFICIAL	='0'	WHERE	SUPERFICIAL	IS NULL	;
UPDATE WORDS SET	ANNOYING	='0'	WHERE	ANNOYING	IS NULL	;
UPDATE WORDS SET	DARK	='0'	WHERE	DARK	IS NULL	;
UPDATE WORDS SET	PASSIONATE	='0'	WHERE	PASSIONATE	IS NULL	;
UPDATE WORDS SET	NOT_AUTHENTIC	='0'	WHERE	NOT_AUTHENTIC	IS NULL	;
UPDATE WORDS SET	GOOD_LYRICS	='0'	WHERE	GOOD_LYRICS	IS NULL	;
UPDATE WORDS SET	BACKGROUND	='0'	WHERE	BACKGROUND	IS NULL	;
UPDATE WORDS SET	TIMELESS	='0'	WHERE	TIMELESS	IS NULL	;
UPDATE WORDS SET	DEPRESSING	='0'	WHERE	DEPRESSING	IS NULL	;
UPDATE WORDS SET	ORIGINAL	='0'	WHERE	ORIGINAL	IS NULL	;
UPDATE WORDS SET	TALENTED	='0'	WHERE	TALENTED	IS NULL	;
UPDATE WORDS SET	WORLDLY	='0'	WHERE	WORLDLY	IS NULL	;
UPDATE WORDS SET	DISTINCTIVE	='0'	WHERE	DISTINCTIVE	IS NULL	;
UPDATE WORDS SET	APPROACHABLE	='0'	WHERE	APPROACHABLE	IS NULL	;
UPDATE WORDS SET	GENIUS	='0'	WHERE	GENIUS	IS NULL	;
UPDATE WORDS SET	TRENDSETTER	='0'	WHERE	TRENDSETTER	IS NULL	;
UPDATE WORDS SET	NOISY	='0'	WHERE	NOISY	IS NULL	;
UPDATE WORDS SET	UPBEAT	='0'	WHERE	UPBEAT	IS NULL	;
UPDATE WORDS SET	RELATABLE	='0'	WHERE	RELATABLE	IS NULL	;
UPDATE WORDS SET	ENERGETIC	='0'	WHERE	ENERGETIC	IS NULL	;
UPDATE WORDS SET	EXCITING	='0'	WHERE	EXCITING	IS NULL	;
UPDATE WORDS SET	EMOTIONAL	='0'	WHERE	EMOTIONAL	IS NULL	;
UPDATE WORDS SET	NOSTALGIC	='0'	WHERE	NOSTALGIC	IS NULL	;
UPDATE WORDS SET	NONE	='0'	WHERE	NONE	IS NULL	;
UPDATE WORDS SET	PROGRESSIVE	='0'	WHERE	PROGRESSIVE	IS NULL	;
UPDATE WORDS SET	SEXY	='0'	WHERE	SEXY	IS NULL	;
UPDATE WORDS SET	OVER	='0'	WHERE	OVER	IS NULL	;
UPDATE WORDS SET	REBELLIOUS	='0'	WHERE	REBELLIOUS	IS NULL	;
UPDATE WORDS SET	FAKE	='0'	WHERE	FAKE	IS NULL	;
UPDATE WORDS SET	CHEESY	='0'	WHERE	CHEESY	IS NULL	;
UPDATE WORDS SET	POPULAR	='0'	WHERE	POPULAR	IS NULL	;
UPDATE WORDS SET	SUPERSTAR	='0'	WHERE	SUPERSTAR	IS NULL	;
UPDATE WORDS SET	RELAXED	='0'	WHERE	RELAXED	IS NULL	;
UPDATE WORDS SET	INTRUSIVE	='0'	WHERE	INTRUSIVE	IS NULL	;
UPDATE WORDS SET	UNORIGINAL	='0'	WHERE	UNORIGINAL	IS NULL	;
UPDATE WORDS SET	DATED	='0'	WHERE	DATED	IS NULL	;
UPDATE WORDS SET	ICONIC	='0'	WHERE	ICONIC	IS NULL	;
UPDATE WORDS SET	UNAPPROACHABLE	='0'	WHERE	UNAPPROACHABLE	IS NULL	;
UPDATE WORDS SET	CLASSIC	='0'	WHERE	CLASSIC	IS NULL	;
UPDATE WORDS SET	PLAYFUL	='0'	WHERE	PLAYFUL	IS NULL	;
UPDATE WORDS SET	ARROGANT	='0'	WHERE	ARROGANT	IS NULL	;
UPDATE WORDS SET	WARM	='0'	WHERE	WARM	IS NULL	;
UPDATE WORDS SET	SOULFUL	='0'	WHERE	SOULFUL	IS NULL	;
UPDATE WORDS SET	SOCIABLE	='0'	WHERE	SOULFUL	IS NULL	;


UPDATE USERS SET	AGE	='39'	WHERE	AGE	IS NULL	;
UPDATE USERS SET	WORKING	='Employed 30+ hours a week'	WHERE	WORKING	IS NULL	;
UPDATE USERS SET	REGION	='Midlands'	WHERE	REGION	IS NULL	;
UPDATE USERS SET	LIST_OWN	='1'	WHERE	LIST_OWN	IS NULL	;
UPDATE USERS SET	LIST_BACK	='2'	WHERE	LIST_BACK	IS NULL	;
UPDATE USERS SET	Q1	='51'	WHERE	Q1	IS NULL	;
UPDATE USERS SET	Q2	='53'	WHERE	Q2	IS NULL	;
UPDATE USERS SET	Q3	='52'	WHERE	Q3	IS NULL	;
UPDATE USERS SET	Q4	='34'	WHERE	Q4	IS NULL	;
UPDATE USERS SET	Q5	='32'	WHERE	Q5	IS NULL	;
UPDATE USERS SET	Q6	='35'	WHERE	Q6	IS NULL	;
UPDATE USERS SET	Q7	='30'	WHERE	Q7	IS NULL	;
UPDATE USERS SET	Q8	='23'	WHERE	Q8	IS NULL	;
UPDATE USERS SET	Q9	='50'	WHERE	Q9	IS NULL	;
UPDATE USERS SET	Q10	='53'	WHERE	Q10	IS NULL	;
UPDATE USERS SET	Q11	='64'	WHERE	Q11	IS NULL	;
UPDATE USERS SET	Q12	='54'	WHERE	Q12	IS NULL	;
UPDATE USERS SET	Q13	='50'	WHERE	Q13	IS NULL	;
UPDATE USERS SET	Q14	='53'	WHERE	Q14	IS NULL	;
UPDATE USERS SET	Q15	='37'	WHERE	Q15	IS NULL	;
UPDATE USERS SET	Q16	='32'	WHERE	Q16	IS NULL	;
UPDATE USERS SET	Q17	='36'	WHERE	Q17	IS NULL	;
UPDATE USERS SET	Q18	='47'	WHERE	Q18	IS NULL	;
UPDATE USERS SET	Q19	='45'	WHERE	Q19	IS NULL	;
	
UPDATE USERS SET LIST_OWN=SUBSTR(LIST_OWN,0,2) ;
UPDATE USERS SET LIST_BACK=SUBSTR(LIST_BACK,0,2) ;
update USERS SET LIST_OWN='0.5' where LIST_OWN='Le';
update USERS  SET LIST_OWN='17' where LIST_OWN='Mo';
update USERS SET LIST_BACK='0.5' where LIST_OWN='Le';
update USERS  SET LIST_BACK='17' where LIST_OWN='Mo';
update USERS region='Northern Ireland' where region='North Ireland';
UPDATE USERS SET GENDER='1' WHERE GENDER='Male'; 
UPDATE USERS SET GENDER='0' WHERE GENDER='Female';


-----#To create the final train data
CREATE TABLE FINAL_REP AS 
SELECT 
A.ARTIST,A.USERS,
B.USERS TRAIN_USER,
B.ARTIST TRAIN_ARTIST,
C.RESPID,
A.HEARD_OF,A.OWN_ARTIST_MUSIC,
A.LIKE_ARTIST,A.UNINSPIRED,A.SOPHISTICATED,A.AGGRESSIVE,A.EDGY,
A.SOCIABLE,A.LAID_BACK,A.WHOLESOME,A.UPLIFTING,A.INTRIGUING,
A.LEGENDARY,A.FREE,A.THOUGHTFUL,A.OUTSPOKEN,
A.SERIOUS,A.UNATTRACTIVE,A.CONFIDENT,A.OLD,A.YOUTHFUL,A.BORING,A.CURRENTS,
A.COLOURFUL,A.STYLISH,A.CHEAP,A.IRRELEVANT,A.HEARTFELT,A.CALM,A.PIONEER,A.OUTGOING,A.INSPIRING,A.BEAUTIFUL,A.FUN,A.AUTHENTIC,A.CREDIBLE,A.WAY_OUT,A.COOL,A.CATCHY,A.SENSITIVE,A.MAINSTREAM,A.SUPERFICIAL,A.ANNOYING,A.DARK,A.PASSIONATE,A.NOT_AUTHENTIC,A.GOOD_LYRICS,A.BACKGROUND,A.TIMELESS,
A.DEPRESSING,A.ORIGINAL,A.TALENTED,A.WORLDLY,A.DISTINCTIVE,A.APPROACHABLE,
A.GENIUS,A.TRENDSETTER,A.NOISY,A.UPBEAT,A.RELATABLE,A.ENERGETIC,
A.EXCITING,A.EMOTIONAL,A.NOSTALGIC,A.NONE,A.PROGRESSIVE,A.SEXY,A.OVER,A.REBELLIOUS,A.FAKE,A.CHEESY,A.POPULAR,A.SUPERSTAR,A.RELAXED,A.INTRUSIVE,A.UNORIGINAL,A.DATED,A.ICONIC,A.UNAPPROACHABLE,A.CLASSIC,A.PLAYFUL,A.ARROGANT,A.WARM,A.SOULFUL,

C.GENDER,C.AGE,C.WORKING,C.REGION,C.MUSIC,C.LIST_OWN,C.LIST_BACK,C.Q1,C.Q2,C.Q3,C.Q4,C.Q5,C.Q6,C.Q7,C.Q8,C.Q9,C.Q10,C.Q11,C.Q12,C.Q13,C.Q14,C.Q15,C.Q16,
C.Q17,C.Q18,C.Q19,--B.ARTIST,B.TRACK,B.USERS,B.RATING,B.TIME

FROM WORDS A,TRAIN B,USER_EMI C 
WHERE A.ARTIST=B.ARTIST AND A.USERS=B.USERS AND A.USERS=C.RESPID;
